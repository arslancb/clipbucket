<h2>{lang ("manage_video_grouping")}</h2>

<script>
  var current_tab = '';
  var current_div = '';
  function display_tab(Li,divid)
  { 
    if(current_tab!='')
      $(current_tab).attr("class","");
    if(current_div!='') 
      $('#'+current_div).hide();
      
    $(Li).attr("class","active");
    $('#'+divid).show();
    
    window.location.hash = 'tab_'+divid.substr(4,3);
    $("#main_form").attr("action",window.location.hash); 
    
    current_tab = Li;
    current_div = divid;
    return false;
  }
</script>
<script>
		$(document).ready(function(){
			var thehash = window.location.hash.substr(5,3);
			$("#tabbed_div > div").hide();
			if(thehash=='') 
				display_tab('#tab_2','div_2');
			else
				display_tab('#tab_'+thehash,'div_'+thehash);
		});
</script>


<ul class="nav nav-tabs mainTabs">
	<li onClick='display_tab(this,"div_1",true)' id="tab_1"> <a href="#">{lang("grouping_type")}</a></li>
	<li onClick='display_tab(this,"div_2",true)' id="tab_2"><a href="#">{lang("grouping")}</a></li>
</ul>
<div id="tabbed_div">
	{* First Tab for grouping types *}
	<div id="div_1" class="main_page_div">
	
		<button class="btn btn-primary btn-sm" type="button" data-toggle="collapse" data-target="#addGroupingTypeDiv" aria-expanded="false" aria-controls="addGroupingTypeDiv">
			{if $showedit!=true} 
				<span class="glyphicon glyphicon-plus"></span> {lang("add")}
			{else}
				<span class="glyphicon glyphicon-pencil"></span> {lang("edit")}{/if}
		</button>
		
		 
		<div {if $showedit!=true}class="collapse"{/if} id="addGroupingTypeDiv">
			<div class="well">
				<form id="groupingTypeAdd" name="groupingTypeAdd" method="post" action="{$video_grouping_manage_page}&#tab_1" class="groupingTypeAdd">
					{if $showedit==true} 
						<input name="grouptypeid" value="{$groupingtype.id}" id="grouptypeid" type="hidden">
						<h3>{lang('edit_grouping_type_nb')}{$groupingtype.id}</h3>
					{/if} 
					<label for="groupingTypeName">{lang("name")}<span>*</span></label> 
					<input type="text" class="form-control" name="groupingTypeName" id="groupingTypeName" value="{$groupingtype.name}">
					<div class="checkbox">
						<label> 
							<input type="checkbox" {if $showedit==true and $groupingtype.in_thumb==1}checked{/if} name="groupingTypeInThumb"> {lang("show_in_video_thumbnails")}
						</label>
					</div>
					<div class="checkbox">
						<label> 
							<input type="checkbox" {if $showedit==true and $groupingtype.in_menu==1}checked{/if} name="groupingTypeInMenu"> {lang("show_in_menu")}
						</label>
					</div>
					<br /> 
					<input type="submit" class="btn btn-primary btn-sm" name="addGroupingType" id="addGroupingType" value="{lang('add')}" class="button" {if $showedit==true} style="display: none" {/if}/> 
					<input type="submit" class="btn btn-primary btn-sm" name="updateGroupingType" id="updateGroupingType" value="{lang('update')}" class="button" {if $showedit!=true} style="display: none" {/if}/>
				</form>
			</div>
		</div>
		<hr/> 
		{if $groupingTypeList}
		{* Displaying grouping types *}
		<form name="manageGroupinfTypes" method="post">
			<div class="btn-group marginBottomSmall">
				<input class="btn btn-danger btn-sm" type="submit" name="deleteSelectedGroupingTypes" value="{lang('remove')}"
					onclick="return confirm_it('Are you sure you want to delete selected elements(s)')" />
			</div>


			<table class="table table-bordered table-striped manageUsersTable">
				<thead>
					<th width="40" align="center" valign="middle" class="left_head"><input type="checkbox" name="checkall" onclick="checkUncheckAll(this);" /></th>
					<th width="50" class="head">id</th>
					<th class="head">{lang('name')}</th>
					<th class="head">{lang('in_thumbnails')}</th>
					<th class="head">{lang('in_the_menu')}</th>
					<th>&nbsp;</th>
				</thead>
				{foreach from=$groupingTypeList  item=u}
				<tr>
					<td><input name="checkGroupingType[]" type="checkbox" id="checkGroupingType" value="{$u.id}" /></td>
					<td>{$u.id}</td>
					<td>
						<div class="row">
							<div class="col-md-10">
								<div class="row">
									<div class="col-md-9">
										<a href="{$video_grouping_manage_page}&editGroupingType={$u.id}#tab_1" class="oneUserName">{$u.name}</a>
									</div>
								</div>
							</div>
					</td>
					<td class="center-text">
						{if $u.in_thumb == '1'}
							<span class="glyphicon glyphicon-ok"></span><span class="sr-only">oui</span>
						{else}
							<span class="glyphicon glyphicon-remove"></span><span class="sr-only">non</span>
						{/if}
					</td>
					<td class="center-text">
						{if $u.in_menu == '1'}
							<span class="glyphicon glyphicon-ok"></span><span class="sr-only">oui</span>
						{else}
							<span class="glyphicon glyphicon-remove"></span><span class="sr-only">non</span>
						{/if}
					</td>
					<td>
						<div id="link_opt-{$u.id}" class="dropdown pull-right">
							<button id="dropdownMenu1" class="btn btn-primary btn-xs dropdown-toggle" data-toggle="dropdown">
								{lang('actions')}<i class="icon-angle-down icon-on-right"></i>
							</button>
							<ul class="dropdown-menu" aria-labelledby="dropdownMenu1" role="menu">
								<li><a role="menuitem" tabindex="-1" href="{$video_grouping_manage_page}&editGroupingType={$u.id}#tab_1"><span class="glyphicon glyphicon-pencil"></span> {lang('edit')}</a></li>
								<li class="divider"></li>
								<li><a role="menuitem" tabindex="-1" href="{$video_grouping_manage_page}&deleteGroupingType={$u.id}#tab_1"><span class="glyphicon glyphicon-trash"></span> {lang('delete')}</a></li>
							</ul>
						</div>
					</td>
				</tr>
				{if $bgcolor == ""} {assign var = bgcolor value = "#EEEEEE"} {else} {assign var = bgcolor value = ""} {/if} {/foreach}
			</table>

			<div class="btn-group">
				<input class="btn btn-danger btn-sm" type="submit" name="deleteSelectedGroupingTypes" value="{lang('remove')}"
					onclick="return confirm_it('Are you sure you want to delete selected elements(s)')" />
			</div>
		</form>
		{else}
		<div align="center">
			<strong><em>{lang("no_grouping_type_found")}</em></strong>
		</div>
		{/if}

	</div>



	{* Second Tab for grouping *}
	<div id="div_2" class="main_page_div">
		<button class="btn btn-primary btn-sm" type="button" data-toggle="collapse" data-target="#addGroupingDiv" aria-expanded="false" aria-controls="addGroupingDiv">
			{if $showedit2!=true} 
				<span class="glyphicon glyphicon-plus"></span> {lang("add")}
			{else}
				<span class="glyphicon glyphicon-pencil"></span> {lang("edit")}{/if}
		</button>

		<div {if $showedit2!=true}class="collapse"{/if} id="addGroupingDiv">
			<div class="well">
				<form id="groupingAdd" name="groupingAdd" method="post" action="{$video_grouping_manage_page}#tab_2" enctype="multipart/form-data">
					<div class="row">
						<div class="col-sm-6">
								<label for="groupingName">{lang("name")}</label> 
								<input type="text" class="form-control" name="groupingName" id="groupingName" {if $showedit2==true}value="{$currentGroup.name}"{/if}>
								<label for="groupingType">{lang("type")}</label> 
								<select class="form-control" name="groupingType" id="groupingType">
									{foreach from=$groupingTypeList item=u}
										<option value="{$u.id}" {if $showedit2==true and $u.id==$currentGroup.grouping_type_id}selected{/if}>{$u.name}</option>
									{/foreach}
								</select>
								
								<label for="groupingDesc">{lang("description")}</label>
								<textarea class="form-control" name="groupingDesc" id="groupingDesc" rows="3">{if $showedit2==true}{$currentGroup.description}{/if}</textarea>
								<label for="groupingColor">{lang("color")}</label> 
								<input type="text" name="groupingColor" class="form-control" id="groupingColor" {if $showedit2==true}value="{$currentGroup.color}"{else}value="#888888"{/if}>
							<div class="checkbox">
								<label> 
									<input type="checkbox" {if $showedit2==true and $currentGroup.in_menu==1}checked{/if} name="groupingInMenu"> {lang("show_in_the_main_menu")}
								</label>
							</div>
						</div>
						<div class="col-sm-6">
		
							<div class="thumb-manager">
								<div class="checkbox">
									<label> <input type="checkbox" name="replace_thumb" value="replace" id="replace-thumb"/> {lang("replace_the_current_thumbnail")}</label>
								</div>
								<div class="form-group">
									<input type="hidden" name="MAX_FILE_SIZE" value="300000" /> 
									<label for="groupingThumb">{lang("thumbnail")}</label> 
									<input type="file" name="groupingThumb" disabled id="groupingThumb" class="" />
									<p class="help-block">{lang("recommanded_size")} : 600&times;340 ({lang("ratio_w_h")} : 1,77)</p>
									<div class="thumb-holder">
										<img src="{if $showedit2==true}{$video_grouping_thumbdir}/{$currentGroup.thumb_url}{else}{$video_grouping_thumbdir}/default.png{/if}" data-pin-nopin="true" class="groupingThumb">
									</div>
								</div>
							</div>
						</div>
					</div>
					{if $showedit2==true}
						<input name="groupingId" type="hidden" value="{$currentGroup.id}">
						<input class="btn btn-primary btn-sm" name="updateGrouping" type="submit" value="{lang('update')}">
					{else}						
						<input class="btn btn-primary btn-sm" name="addGrouping" type="submit" value="{lang('add')}">
					{/if}
					<input class="btn btn-primary btn-sm" name="reinitGrouping" type="reset" value="{lang('reset')}">					
					<div class="clearfix"></div>
				</form>
			</div>
		</div>

		<hr/>
		<button class="btn btn-primary btn-sm" type="button" onclick="toggle_search('searchdiv')" ><span class="glyphicon glyphicon-search"></span>{lang('filter')}</button>
		<br/>
		<div class="search_box" id="searchdiv" {if $showfilter!=true} style="display:none"{/if}>  
			<div class="well">
				<form id="groupingSearch" name="groupingSearch" method="post" action="" class="groupingSearch">
					<div class="row">
						<div class="col-sm-6">
							<div class="form-group">
								<label for="title">{lang('name')} </label> 
								<input name="name" class="form-control" type="text" class="input" id="name" value="{$searchname}" />
							</div>
						</div>
					</div>
				  <input type="submit" class="btn btn-primary btn-sm" name="filter" id="filter" value="{lang('filter')}" class="button"/>
				</form>
			</div>
		</div>
		{if $total != 0}
		<hr/>
		<!-- DIsplaying Videos Ends-->
		{include file="$style_dir/blocks/pagination.html" }
			<form name="groupingList" action="" method="post">
				<input class="btn btn-primary btn-sm" name="updateOrder" type="submit" value="{lang('reorder')}">
				<input class="btn btn-danger btn-sm" name="deleteSelected" type="submit" value="{lang('remove')}">
				<table width="100%" class="table table-striped">
					<thead>
						<tr>
							<th><input type="checkbox" name="checkall" onclick="checkUncheckAll(this);"/></th>
							<th>{lang("id")}</th>
							<th>{lang("name")}</th>
							<th class="center-text">{lang("order")}</th>
							<th>{lang("description")}</th>
							<th class="center-text">{lang("in_the_menu")}</th>
							<th class="center-text">{lang("grouping_type")}</th>
							<th class="center-text">{lang("thumbnail")}</th>
							<th class="center-text">{lang("color")}</th>
							<th>&nbsp;</th>
						</tr>
					</thead>
					<tbody>
					
					{foreach from=$vdogrp item=grp}
					<tr>
						<th scope="row"><input name="checkGrouping[]" type="checkbox" id="checkGrouping" value="{$grp.id}" /></th>
						<td>{$grp.id}</td>
						<td>                        
							<a href="{$video_grouping_manage_page}&editGrouping={$grp.id}" class="oneUserName">{$grp.name} </a>
						</td>
						<td class="center-text"><input name="order_{$grp.id}" type="text" class="order" value="{$grp.place}" size="2" maxlength="2" /></td>
						<td>{$grp.description}</td>
						<td class="center-text">
							{if $grp.in_menu == '1'}
								<span class="glyphicon glyphicon-ok"></span><span class="sr-only">oui</span>
							{else}
								<span class="glyphicon glyphicon-remove"></span><span class="sr-only">non</span>
							{/if}
						</td>
						<td>{$grp.grouping_type_name}</td>
						<td class="center-text">
							{if $grp.thumb_url}
								<img src="{$video_grouping_thumbdir}/{$grp.thumb_url}" data-pin-nopin="true" class="disc-thumb">
							{else}
								<i>{lang("none")}</i>	
							{/if}
						</td>
						<td class="center-text"><span class="glyphicon glyphicon-stop" style="color:{$grp.color}"></span></td>
						<td><div class="dropdown">
							<button type="button" class="btn btn-primary btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
								{lang("actions")} <i class="caret"></i>
							</button>
							<ul class="dropdown-menu">
								<li>
									<a href="{$video_grouping_manage_page}&editGrouping={$grp.id}"><span class="glyphicon glyphicon-pencil"></span> {lang("edit")}</a>
								</li>
								{if $grp.in_menu == 1}
									<li>
										<a href="{$video_grouping_manage_page}&setInMenu=0&id={$grp.id}"><span class="glyphicon glyphicon-eye-close"></span> {lang("hide_from_menu")}</a>
									</li>
								{else if $video_groupings[list].in_menu == 0}
									<li>
										<a href="{$video_grouping_manage_page}&setInMenu=1&id={$grp.id}"><span class="glyphicon glyphicon-eye-open"></span> {lang("show_in_menu")}</a>
									</li>
								{/if}
								<li>
									<a href="{$video_grouping_manage_page}&deleteGrouping={$grp.id}"><span class="glyphicon glyphicon-trash"></span> {lang("delete")}</a>
								</li>
							</ul>
						</div></td>
					</tr>
					{/foreach}
						</tbody>
					
				</table>
				<input class="btn btn-primary btn-sm" name="updateOrder" type="submit" value="{lang('reorder')}">
				<input class="btn btn-danger btn-sm" name="deleteSelected" type="submit" value="{lang('remove')}">
			</form>
			<!-- DIsplaying Videos Ends-->
			{include file="$style_dir/blocks/pagination.html" }
		{else}
			<div align="center"><strong><em>{lang("no_grouping_found")}</em></strong></div>
		{/if}
	</div>
</div>




<script>
    $(document).ready(function() {
        $('#page_content').summernote();
    });
	//activate 
	$('#replace-thumb').change(function() {
    $('#groupingThumb').attr('disabled',!this.checked)
});
</script> 
